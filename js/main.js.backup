// ä¸»è¦äº¤äº’é€»è¾‘

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    console.log('åŒ—äº¬å¸‚æ•°å­—äº§ä¸šå‘å±•æ”¯æ’‘å¹³å°åŠ è½½å®Œæˆ');

    // åˆå§‹åŒ–æ€»è§ˆé¡µé¢çš„å›¾è¡¨
    initIndustryChart();
    initGrowthChart();
    initInnovationChart();

    // æ·»åŠ æ•°å­—æ»šåŠ¨æ•ˆæœ
    animateNumbers();
});

// é¡µé¢åˆ‡æ¢
function showSection(sectionId) {
    // éšè—æ‰€æœ‰é¡µé¢
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // æ˜¾ç¤ºç›®æ ‡é¡µé¢
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.style.display = 'block';
    }

    // æ›´æ–°å¯¼èˆªèœå•æ¿€æ´»çŠ¶æ€
    const navLinks = document.querySelectorAll('.nav-menu a');
    navLinks.forEach(link => {
        link.classList.remove('active');
    });

    const activeLink = document.querySelector(`.nav-menu a[href="#${sectionId}"]`);
    if (activeLink) {
        activeLink.classList.add('active');
    }

    // æ ¹æ®ä¸åŒé¡µé¢åŠ è½½ç›¸åº”å†…å®¹
    switch(sectionId) {
        case 'overview':
            // æ€»è§ˆé¡µé¢å·²ç»åœ¨é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
            break;
        case 'pre-investment':
            loadPreInvestmentPage();
            break;
        case 'mid-investment':
            loadMidInvestmentPage();
            break;
        case 'post-investment':
            loadPostInvestmentPage();
            break;
        case 'data-center':
            loadDataCenterPage();
            break;
    }
}

// Tabåˆ‡æ¢
function switchTab(tabId) {
    // éšè—æ‰€æœ‰tabå†…å®¹
    const tabContents = document.querySelectorAll('.tab-content');
    tabContents.forEach(content => {
        content.classList.remove('active');
    });

    // ç§»é™¤æ‰€æœ‰tabçš„æ¿€æ´»çŠ¶æ€
    const tabs = document.querySelectorAll('.tab');
    tabs.forEach(tab => {
        tab.classList.remove('active');
    });

    // æ˜¾ç¤ºç›®æ ‡tabå†…å®¹
    const targetTab = document.getElementById(tabId);
    if (targetTab) {
        targetTab.classList.add('active');
    }

    // æ¿€æ´»å¯¹åº”çš„tabæŒ‰é’®
    event.target.classList.add('active');
}

// æ•°å­—æ»šåŠ¨åŠ¨ç”»
function animateNumbers() {
    const statValues = document.querySelectorAll('.stat-value');

    statValues.forEach(element => {
        const targetValue = element.textContent;
        const numberMatch = targetValue.match(/[\d,]+/);

        if (numberMatch) {
            const finalNumber = parseInt(numberMatch[0].replace(/,/g, ''));
            const suffix = targetValue.replace(numberMatch[0], '');
            let currentNumber = 0;
            const increment = finalNumber / 50;
            const duration = 1000;
            const stepTime = duration / 50;

            element.textContent = '0' + suffix;

            const timer = setInterval(() => {
                currentNumber += increment;
                if (currentNumber >= finalNumber) {
                    clearInterval(timer);
                    element.textContent = finalNumber.toLocaleString() + suffix;
                } else {
                    element.textContent = Math.floor(currentNumber).toLocaleString() + suffix;
                }
            }, stepTime);
        }
    });
}

// åˆ·æ–°æ•°æ®
function refreshData() {
    const button = event.target;
    button.innerHTML = '<span class="loading"></span> åˆ·æ–°ä¸­...';
    button.disabled = true;

    setTimeout(() => {
        button.innerHTML = 'åˆ·æ–°æ•°æ®';
        button.disabled = false;
        showNotification('æ•°æ®å·²æ›´æ–°', 'success');

        // é‡æ–°åˆå§‹åŒ–å›¾è¡¨
        initIndustryChart();
        initGrowthChart();
        initInnovationChart();
    }, 1500);
}

// æ˜¾ç¤ºäº§ä¸šè¯¦æƒ…
function showIndustryDetail() {
    showModal('é‡ç‚¹äº§ä¸šé“¾è¯¦æƒ…', `
        <div class="grid-2">
            <div class="info-item">
                <div class="info-label">äº§ä¸šé“¾æ€»æ•°</div>
                <div class="info-value">28æ¡</div>
            </div>
            <div class="info-item">
                <div class="info-label">å®Œæ•´åº¦å¤§äº90%</div>
                <div class="info-value">8æ¡</div>
            </div>
            <div class="info-item">
                <div class="info-label">é‡ç‚¹åŸ¹è‚²</div>
                <div class="info-value">12æ¡</div>
            </div>
            <div class="info-item">
                <div class="info-label">æ–°å¢äº§ä¸šé“¾</div>
                <div class="info-value">3æ¡</div>
            </div>
        </div>
        <div style="margin-top: 20px;">
            <h4 style="margin-bottom: 10px;">é‡ç‚¹å‘å±•æ–¹å‘</h4>
            <div class="mini-card">
                <strong>å¼ºé“¾å·¥ç¨‹ï¼š</strong>é›†æˆç”µè·¯ã€äººå·¥æ™ºèƒ½ã€ç”Ÿç‰©åŒ»è¯ç­‰ä¼˜åŠ¿äº§ä¸š
            </div>
            <div class="mini-card">
                <strong>è¡¥é“¾å·¥ç¨‹ï¼š</strong>æ–°èƒ½æºæ±½è½¦å…³é”®é›¶éƒ¨ä»¶ã€é«˜ç«¯åŒ»ç–—å™¨æ¢°ç­‰
            </div>
            <div class="mini-card">
                <strong>å»¶é“¾å·¥ç¨‹ï¼š</strong>å·¥ä¸šäº’è”ç½‘ã€æ™ºèƒ½åˆ¶é€ ã€æ•°å­—ç»æµç­‰æ–°å…´é¢†åŸŸ
            </div>
        </div>
    `);
}

// æ˜¾ç¤ºä¼ä¸šè¯¦æƒ…
function showEnterpriseDetail() {
    showModal('è§„ä¸Šä¼ä¸šç»Ÿè®¡', `
        <div class="grid-3">
            <div class="info-item">
                <div class="info-label">è§„ä¸Šä¼ä¸šæ€»æ•°</div>
                <div class="info-value">15,847å®¶</div>
            </div>
            <div class="info-item">
                <div class="info-label">ä¸Šå¸‚ä¼ä¸š</div>
                <div class="info-value">423å®¶</div>
            </div>
            <div class="info-item">
                <div class="info-label">ç‹¬è§’å…½ä¼ä¸š</div>
                <div class="info-value">102å®¶</div>
            </div>
            <div class="info-item">
                <div class="info-label">é«˜æ–°æŠ€æœ¯ä¼ä¸š</div>
                <div class="info-value">8,934å®¶</div>
            </div>
            <div class="info-item">
                <div class="info-label">ä¸“ç²¾ç‰¹æ–°</div>
                <div class="info-value">1,567å®¶</div>
            </div>
            <div class="info-item">
                <div class="info-label">çªç¾šä¼ä¸š</div>
                <div class="info-value">645å®¶</div>
            </div>
        </div>
        <div style="margin-top: 20px;">
            <h4 style="margin-bottom: 10px;">ä¼ä¸šåˆ†å¸ƒçƒ­åŠ›å›¾</h4>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <span class="badge badge-success">æµ·æ·€åŒº: 4,567å®¶</span>
                <span class="badge badge-info">æœé˜³åŒº: 3,821å®¶</span>
                <span class="badge badge-warning">å¤§å…´åŒº: 1,456å®¶</span>
                <span class="badge badge-info">æ˜Œå¹³åŒº: 1,234å®¶</span>
                <span class="badge badge-warning">é¡ºä¹‰åŒº: 867å®¶</span>
            </div>
        </div>
    `);
}

// æ˜¾ç¤ºæ”¿ç­–è¯¦æƒ…
function showPolicyDetail() {
    showModal('äº§ä¸šæ”¿ç­–åº“', `
        <div class="grid-2">
            <div class="info-item">
                <div class="info-label">æ”¿ç­–æ€»æ•°</div>
                <div class="info-value">1,245æ¡</div>
            </div>
            <div class="info-item">
                <div class="info-label">æœ¬æœˆæ–°å¢</div>
                <div class="info-value">156æ¡</div>
            </div>
        </div>
        <div style="margin-top: 20px;">
            <h4 style="margin-bottom: 10px;">æ”¿ç­–åˆ†ç±»ç»Ÿè®¡</h4>
            <table>
                <thead>
                    <tr>
                        <th>æ”¿ç­–ç±»å‹</th>
                        <th>æ•°é‡</th>
                        <th>å æ¯”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>è´¢æ”¿è¡¥è´´</td>
                        <td>356æ¡</td>
                        <td><span class="badge badge-success">28.6%</span></td>
                    </tr>
                    <tr>
                        <td>ç¨æ”¶ä¼˜æƒ </td>
                        <td>289æ¡</td>
                        <td><span class="badge badge-info">23.2%</span></td>
                    </tr>
                    <tr>
                        <td>äººæ‰å¼•è¿›</td>
                        <td>178æ¡</td>
                        <td><span class="badge badge-warning">14.3%</span></td>
                    </tr>
                    <tr>
                        <td>èèµ„æ”¯æŒ</td>
                        <td>145æ¡</td>
                        <td><span class="badge badge-info">11.6%</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    `);
}

// æ˜¾ç¤ºæ‹›å•†è¯¦æƒ…
function showInvestmentDetail() {
    showModal('æ‹›å•†é¡¹ç›®ç»Ÿè®¡ï¼ˆæœ¬å¹´åº¦ï¼‰', `
        <div class="grid-2">
            <div class="info-item">
                <div class="info-label">æ‹›å•†é¡¹ç›®æ€»æ•°</div>
                <div class="info-value">368ä¸ª</div>
            </div>
            <div class="info-item">
                <div class="info-label">å·²è½åœ°é¡¹ç›®</div>
                <div class="info-value">57ä¸ª</div>
            </div>
            <div class="info-item">
                <div class="info-label">æŠ•èµ„æ€»é¢</div>
                <div class="info-value">1,456äº¿å…ƒ</div>
            </div>
            <div class="info-item">
                <div class="info-label">é¢„æœŸäº§å€¼</div>
                <div class="info-value">3,890äº¿å…ƒ</div>
            </div>
        </div>
        <div style="margin-top: 20px;">
            <h4 style="margin-bottom: 10px;">é¡¹ç›®è¿›åº¦åˆ†å¸ƒ</h4>
            <div class="mini-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>è°ˆåˆ¤ä¸­</span>
                    <span><strong>125ä¸ª (34%)</strong></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 34%;"></div>
                </div>
            </div>
            <div class="mini-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>å·²ç­¾çº¦</span>
                    <span><strong>186ä¸ª (51%)</strong></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 51%;"></div>
                </div>
            </div>
            <div class="mini-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>å·²è½åœ°</span>
                    <span><strong>57ä¸ª (15%)</strong></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 15%;"></div>
                </div>
            </div>
        </div>
    `);
}

// æ˜¾ç¤ºæ‰€æœ‰äº§ä¸šé“¾
function showAllChains() {
    let html = '<div class="card-grid">';

    industryData.chains.forEach(chain => {
        const badgeClass = chain.completeness >= 85 ? 'badge-success' : 'badge-warning';
        html += `
            <div class="mini-card" onclick="showChainDetail('${chain.name}')">
                <div class="mini-card-title">${chain.icon} ${chain.name}äº§ä¸šé“¾</div>
                <div class="mini-card-content">
                    <div style="margin-bottom: 8px;">ä¼ä¸šæ•°é‡: <strong>${chain.companies}å®¶</strong></div>
                    <div style="margin-bottom: 8px;">äº§å€¼è§„æ¨¡: <strong>${chain.output}äº¿å…ƒ</strong></div>
                    <div style="margin-bottom: 8px;">åŒæ¯”å¢é•¿: <strong class="trend-up">+${chain.growth}%</strong></div>
                    <div>å®Œæ•´åº¦: <span class="badge ${badgeClass}">${chain.completeness}%</span></div>
                </div>
            </div>
        `;
    });

    html += '</div>';

    showModal('å…¨éƒ¨äº§ä¸šé“¾å›¾è°±', html);
}

// æ˜¾ç¤ºäº§ä¸šé“¾è¯¦æƒ…
function showChainDetail(chainName) {
    const chain = industryData.chains.find(c => c.name === chainName);
    if (!chain) return;

    const badgeClass = chain.completeness >= 85 ? 'badge-success' : 'badge-warning';

    const html = `
        <div class="grid-2" style="margin-bottom: 20px;">
            <div class="info-item">
                <div class="info-label">ä¼ä¸šæ•°é‡</div>
                <div class="info-value">${chain.companies}å®¶</div>
            </div>
            <div class="info-item">
                <div class="info-label">äº§å€¼è§„æ¨¡</div>
                <div class="info-value">${chain.output}äº¿å…ƒ</div>
            </div>
            <div class="info-item">
                <div class="info-label">åŒæ¯”å¢é•¿</div>
                <div class="info-value" style="color: #48bb78;">+${chain.growth}%</div>
            </div>
            <div class="info-item">
                <div class="info-label">äº§ä¸šé“¾å®Œæ•´åº¦</div>
                <div class="info-value"><span class="badge ${badgeClass}">${chain.completeness}%</span></div>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <h4 style="margin-bottom: 10px; color: #2d3748;">ä¸»è¦åˆ†å¸ƒåŒºåŸŸ</h4>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                ${chain.districts.map(d => `<span class="badge badge-info">${d}</span>`).join('')}
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <h4 style="margin-bottom: 10px; color: #2d3748;">é‡ç‚¹ä¼ä¸š</h4>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                ${chain.keyCompanies.map(c => `<span class="badge badge-success">${c}</span>`).join('')}
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <h4 style="margin-bottom: 10px; color: #2d3748;">äº§ä¸šé“¾ç»“æ„</h4>
            <div class="mini-card">
                <div style="font-weight: 600; color: #4facfe; margin-bottom: 8px;">ä¸Šæ¸¸ç¯èŠ‚</div>
                <div>${chain.upstream.join('ã€')}</div>
            </div>
            <div class="mini-card">
                <div style="font-weight: 600; color: #667eea; margin-bottom: 8px;">ä¸­æ¸¸ç¯èŠ‚</div>
                <div>${chain.midstream.join('ã€')}</div>
            </div>
            <div class="mini-card">
                <div style="font-weight: 600; color: #f093fb; margin-bottom: 8px;">ä¸‹æ¸¸ç¯èŠ‚</div>
                <div>${chain.downstream.join('ã€')}</div>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <h4 style="margin-bottom: 10px; color: #2d3748;">è–„å¼±ç¯èŠ‚ï¼ˆè¡¥é“¾æœºä¼šï¼‰</h4>
            <div class="mini-card" style="border-left-color: #f56565;">
                ${chain.weakness.map(w => `<span class="badge badge-danger">${w}</span>`).join(' ')}
            </div>
        </div>

        <div>
            <h4 style="margin-bottom: 10px; color: #2d3748;">å‘å±•æœºé‡</h4>
            <div class="mini-card" style="border-left-color: #48bb78;">
                ${chain.opportunity.map(o => `<span class="badge badge-success">${o}</span>`).join(' ')}
            </div>
        </div>

        <div style="margin-top: 20px;">
            <div id="chainChart" style="width: 100%; height: 400px;"></div>
        </div>
    `;

    showModal(`${chain.icon} ${chain.name}äº§ä¸šé“¾è¯¦æƒ…`, html);

    // å»¶è¿Ÿåˆå§‹åŒ–å›¾è¡¨ï¼Œç¡®ä¿DOMå·²æ¸²æŸ“
    setTimeout(() => {
        initChainChart(chainName);
    }, 100);
}

// æ¨¡æ€æ¡†æ˜¾ç¤º
function showModal(title, content) {
    const modal = document.getElementById('detailModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');

    modalTitle.textContent = title;
    modalBody.innerHTML = content;
    modal.classList.add('active');
}

// å…³é—­æ¨¡æ€æ¡†
function closeModal() {
    const modal = document.getElementById('detailModal');
    modal.classList.remove('active');
}

// ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
window.onclick = function(event) {
    const modal = document.getElementById('detailModal');
    if (event.target === modal) {
        modal.classList.remove('active');
    }
}

// é€šçŸ¥æç¤º
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        padding: 15px 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 3000;
        animation: slideInRight 0.3s;
        border-left: 4px solid ${type === 'success' ? '#48bb78' : '#4299e1'};
    `;

    notification.innerHTML = `
        <div style="display: flex; align-items: center; gap: 10px;">
            <span style="font-size: 20px;">${type === 'success' ? 'âœ“' : 'â„¹'}</span>
            <span style="color: #2d3748;">${message}</span>
        </div>
    `;

    document.body.appendChild(notification);

    setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 2000);
}

// åŠ è½½æ‹›å‰åˆ†æé¡µé¢
function loadPreInvestmentPage() {
    const container = document.getElementById('pre-investment');
    if (container.children.length > 0) return; // å·²åŠ è½½

    container.innerHTML = `
        <div class="content-card">
            <div class="card-header">
                <h2 class="card-title">æ‹›å‰æ™ºèƒ½åˆ†æ</h2>
                <div class="card-actions">
                    <button class="btn btn-primary" onclick="generateAnalysisReport()">ç”Ÿæˆåˆ†ææŠ¥å‘Š</button>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchPreTab('industry-analysis')">äº§ä¸šå›¾è°±</button>
                <button class="tab" onclick="switchPreTab('enterprise-analysis')">ä¼ä¸šåˆ†æ</button>
                <button class="tab" onclick="switchPreTab('chain-analysis')">å¼ºé“¾è¡¥é“¾</button>
            </div>

            <div id="pre-industry-analysis" class="tab-content active">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="æœç´¢äº§ä¸š..." onkeyup="searchIndustry(this.value)">
                    <span class="search-icon">ğŸ”</span>
                </div>

                <div class="card-grid">
                    ${industryData.chains.map(chain => `
                        <div class="mini-card" onclick="showChainAnalysis('${chain.name}')">
                            <div class="mini-card-title">${chain.icon} ${chain.name}</div>
                            <div class="mini-card-content">
                                <div style="margin-bottom: 8px;">ä¼ä¸š: ${chain.companies}å®¶ | äº§å€¼: ${chain.output}äº¿</div>
                                <div style="margin-bottom: 8px;">å¢é•¿: <span class="trend-up">+${chain.growth}%</span></div>
                                <div>å®Œæ•´åº¦: <span class="badge ${chain.completeness >= 85 ? 'badge-success' : 'badge-warning'}">${chain.completeness}%</span></div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>

            <div id="pre-enterprise-analysis" class="tab-content">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="æœç´¢ä¼ä¸š..." onkeyup="searchEnterprise(this.value)">
                    <span class="search-icon">ğŸ”</span>
                </div>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ä¼ä¸šåç§°</th>
                                <th>è¡Œä¸š</th>
                                <th>åŒºåŸŸ</th>
                                <th>è¥æ”¶ï¼ˆä¸‡å…ƒï¼‰</th>
                                <th>æˆé•¿æ€§</th>
                                <th>åˆ›æ–°è¯„åˆ†</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${enterpriseData.list.map(ent => `
                                <tr>
                                    <td><strong>${ent.name}</strong></td>
                                    <td>${ent.type}</td>
                                    <td>${ent.district}</td>
                                    <td>${ent.revenue.toLocaleString()}</td>
                                    <td><span class="badge ${ent.growth === 'high' ? 'badge-success' : 'badge-warning'}">${ent.growth === 'high' ? 'é«˜' : 'ä¸­'}</span></td>
                                    <td>${ent.innovation}/5.0</td>
                                    <td><button class="btn btn-secondary" onclick="showEnterpriseAnalysis(${ent.id})">è¯¦æƒ…</button></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="pre-chain-analysis" class="tab-content">
                <h3 style="margin-bottom: 20px; color: #2d3748;">å¼ºé“¾è¡¥é“¾åˆ†æ</h3>

                <div class="mini-card" style="border-left-color: #48bb78; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">ğŸ”— å¼ºé“¾æœºä¼šï¼ˆä¼˜åŠ¿äº§ä¸šï¼‰</h4>
                    <div class="card-grid">
                        <div class="mini-card">
                            <div class="mini-card-title">äººå·¥æ™ºèƒ½</div>
                            <div class="mini-card-content">é¾™å¤´ä¼ä¸šé›†èšï¼Œå»ºè®®å¼•è¿›ç®—åŠ›å¹³å°å’Œå¤§æ¨¡å‹åº”ç”¨ä¼ä¸š</div>
                        </div>
                        <div class="mini-card">
                            <div class="mini-card-title">é›†æˆç”µè·¯</div>
                            <div class="mini-card-content">è®¾è®¡èƒ½åŠ›çªå‡ºï¼Œå»ºè®®åŠ å¼ºå…ˆè¿›åˆ¶ç¨‹å’Œå°è£…æµ‹è¯•</div>
                        </div>
                    </div>
                </div>

                <div class="mini-card" style="border-left-color: #f56565; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">â›“ï¸ è¡¥é“¾æœºä¼šï¼ˆè–„å¼±ç¯èŠ‚ï¼‰</h4>
                    <div class="card-grid">
                        <div class="mini-card" onclick="showSupplementOpportunity('æ–°èƒ½æºæ±½è½¦')">
                            <div class="mini-card-title">æ–°èƒ½æºæ±½è½¦ - åŠ¨åŠ›ç”µæ± </div>
                            <div class="mini-card-content">
                                <div>ç¼ºå¤±ç¯èŠ‚: æ­£æææ–™ã€ç”µè§£æ¶²</div>
                                <div style="margin-top: 8px;">
                                    <span class="badge badge-danger">ç´§æ€¥åº¦: é«˜</span>
                                    <span class="badge badge-info">ç›®æ ‡ä¼ä¸š: 15å®¶</span>
                                </div>
                            </div>
                        </div>
                        <div class="mini-card" onclick="showSupplementOpportunity('ç”Ÿç‰©åŒ»è¯')">
                            <div class="mini-card-title">ç”Ÿç‰©åŒ»è¯ - é«˜ç«¯å™¨æ¢°</div>
                            <div class="mini-card-content">
                                <div>ç¼ºå¤±ç¯èŠ‚: é«˜ç«¯å½±åƒè®¾å¤‡ã€æ‰‹æœ¯æœºå™¨äºº</div>
                                <div style="margin-top: 8px;">
                                    <span class="badge badge-warning">ç´§æ€¥åº¦: ä¸­</span>
                                    <span class="badge badge-info">ç›®æ ‡ä¼ä¸š: 8å®¶</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mini-card" style="border-left-color: #4facfe;">
                    <h4 style="margin-bottom: 10px;">ğŸš€ å»¶é“¾æœºä¼šï¼ˆæ–°å…´æ–¹å‘ï¼‰</h4>
                    <div class="card-grid">
                        <div class="mini-card">
                            <div class="mini-card-title">å…ƒå®‡å®™äº§ä¸š</div>
                            <div class="mini-card-content">VR/ARç¡¬ä»¶ã€å†…å®¹åˆ¶ä½œã€è™šæ‹Ÿç¤¾äº¤å¹³å°</div>
                        </div>
                        <div class="mini-card">
                            <div class="mini-card-title">å•†ä¸šèˆªå¤©</div>
                            <div class="mini-card-content">å«æ˜Ÿåˆ¶é€ ã€ç«ç®­å‘å°„ã€åœ°é¢è®¾å¤‡</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// åŠ è½½æ‹›ä¸­åŒ¹é…é¡µé¢
function loadMidInvestmentPage() {
    const container = document.getElementById('mid-investment');
    if (container.children.length > 0) return;

    container.innerHTML = `
        <div class="content-card">
            <div class="card-header">
                <h2 class="card-title">æ‹›ä¸­ç²¾å‡†åŒ¹é…</h2>
                <div class="card-actions">
                    <button class="btn btn-primary" onclick="showPolicySimulator()">æ”¿ç­–æ¨¡æ‹Ÿå™¨</button>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchMidTab('policy-match')">æ”¿ç­–åŒ¹é…</button>
                <button class="tab" onclick="switchMidTab('policy-design')">æ”¿ç­–è®¾è®¡</button>
                <button class="tab" onclick="switchMidTab('investment-projects')">æ‹›å•†é¡¹ç›®</button>
            </div>

            <div id="mid-policy-match" class="tab-content active">
                <h3 style="margin-bottom: 20px;">æ™ºèƒ½æ”¿ç­–åŒ¹é…å¼•æ“</h3>

                <div class="mini-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%); border-left-color: #667eea;">
                    <h4>é€‰æ‹©ä¼ä¸šè¿›è¡Œæ”¿ç­–åŒ¹é…</h4>
                    <select id="enterpriseSelect" onchange="matchPolicies(this.value)" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; margin-top: 10px;">
                        <option value="">-- è¯·é€‰æ‹©ä¼ä¸š --</option>
                        ${enterpriseData.list.map(ent => `<option value="${ent.id}">${ent.name} (${ent.type})</option>`).join('')}
                    </select>
                </div>

                <div id="policyMatchResult" style="margin-top: 20px;"></div>
            </div>

            <div id="mid-policy-design" class="tab-content">
                <h3 style="margin-bottom: 20px;">å®šåˆ¶åŒ–æ”¿ç­–è®¾è®¡</h3>

                <div class="grid-2">
                    <div class="mini-card">
                        <h4 style="margin-bottom: 15px;">é¡¹ç›®åŸºæœ¬ä¿¡æ¯</h4>
                        <div class="info-item">
                            <div class="info-label">é¡¹ç›®åç§°</div>
                            <input type="text" placeholder="è¾“å…¥é¡¹ç›®åç§°" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </div>
                        <div class="info-item">
                            <div class="info-label">æŠ•èµ„è§„æ¨¡ï¼ˆä¸‡å…ƒï¼‰</div>
                            <input type="number" placeholder="è¾“å…¥æŠ•èµ„é‡‘é¢" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </div>
                        <div class="info-item">
                            <div class="info-label">è¡Œä¸šç±»å‹</div>
                            <select style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
                                ${industryData.chains.map(c => `<option>${c.name}</option>`).join('')}
                            </select>
                        </div>
                    </div>

                    <div class="mini-card">
                        <h4 style="margin-bottom: 15px;">é¢„æœŸæ•ˆç›Š</h4>
                        <div class="info-item">
                            <div class="info-label">é¢„æœŸäº§å€¼ï¼ˆä¸‡å…ƒ/å¹´ï¼‰</div>
                            <input type="number" placeholder="é¢„æœŸå¹´äº§å€¼" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </div>
                        <div class="info-item">
                            <div class="info-label">é¢„æœŸç¨æ”¶ï¼ˆä¸‡å…ƒ/å¹´ï¼‰</div>
                            <input type="number" placeholder="é¢„æœŸå¹´ç¨æ”¶" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </div>
                        <div class="info-item">
                            <div class="info-label">é¢„æœŸå°±ä¸šï¼ˆäººï¼‰</div>
                            <input type="number" placeholder="é¢„æœŸå°±ä¸šäººæ•°" style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="generatePolicyPackage()" style="margin-top: 20px; width: 100%;">ç”Ÿæˆæ”¿ç­–ç»„åˆæ–¹æ¡ˆ</button>

                <div id="policyPackageResult" style="margin-top: 20px;"></div>
            </div>

            <div id="mid-investment-projects" class="tab-content">
                <h3 style="margin-bottom: 20px;">åœ¨è°ˆæ‹›å•†é¡¹ç›®</h3>

                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>é¡¹ç›®åç§°</th>
                                <th>è¡Œä¸š</th>
                                <th>æŠ•èµ„é¢ï¼ˆä¸‡ï¼‰</th>
                                <th>è¿›åº¦</th>
                                <th>çŠ¶æ€</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${investmentData.projects.map(proj => `
                                <tr>
                                    <td><strong>${proj.name}</strong></td>
                                    <td>${proj.industry}</td>
                                    <td>${proj.investAmount.toLocaleString()}</td>
                                    <td>
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: ${proj.progress}%;"></div>
                                        </div>
                                        <div style="font-size: 12px; margin-top: 4px;">${proj.progress}%</div>
                                    </td>
                                    <td><span class="badge ${proj.stage === 'å·²è½åœ°' ? 'badge-success' : proj.stage === 'å·²ç­¾çº¦' ? 'badge-info' : 'badge-warning'}">${proj.stage}</span></td>
                                    <td><button class="btn btn-secondary" onclick="showProjectDetail('${proj.id}')">è¯¦æƒ…</button></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    `;
}

// åŠ è½½æ‹›åæœåŠ¡é¡µé¢
function loadPostInvestmentPage() {
    const container = document.getElementById('post-investment');
    if (container.children.length > 0) return;

    container.innerHTML = `
        <div class="content-card">
            <div class="card-header">
                <h2 class="card-title">æ‹›åå…¨ç¨‹æœåŠ¡</h2>
                <div class="card-actions">
                    <button class="btn btn-primary" onclick="showServiceDashboard()">æœåŠ¡æ€»è§ˆ</button>
                </div>
            </div>

            <div class="stats-grid" style="margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-title">æœåŠ¡ä¼ä¸šæ•°</div>
                    <div class="stat-value">${serviceData.stats.servedCompanies.toLocaleString()}</div>
                    <div class="stat-trend trend-up">
                        <span>è¦†ç›–ç‡ ${Math.round(serviceData.stats.servedCompanies / serviceData.stats.totalCompanies * 100)}%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">é‡‘èæœåŠ¡</div>
                    <div class="stat-value">${serviceData.stats.financialServices}</div>
                    <div class="stat-trend trend-up">
                        <span>é‡‘é¢ ${serviceData.stats.financialAmount.toLocaleString()}äº¿</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">äººæ‰å¼•è¿›</div>
                    <div class="stat-value">${serviceData.stats.talentCount}</div>
                    <div class="stat-trend trend-up">
                        <span>æœåŠ¡ ${serviceData.stats.talentServices} æ¬¡</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">äº§ä¸šå¯¹æ¥</div>
                    <div class="stat-value">${serviceData.stats.industryConnections}</div>
                    <div class="stat-trend">
                        <span>æœ¬æœˆ +156</span>
                    </div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchPostTab('financial')">é‡‘èæœåŠ¡</button>
                <button class="tab" onclick="switchPostTab('talent')">äººæ‰æœåŠ¡</button>
                <button class="tab" onclick="switchPostTab('industry')">äº§ä¸šå¯¹æ¥</button>
                <button class="tab" onclick="switchPostTab('monitoring')">ç›‘æµ‹é¢„è­¦</button>
            </div>

            <div id="post-financial" class="tab-content active">
                <h3 style="margin-bottom: 20px;">é‡‘èäº§å“æ™ºèƒ½åŒ¹é…</h3>

                <div class="card-grid">
                    ${serviceData.financialProducts.map(product => `
                        <div class="mini-card" onclick="showFinancialProduct('${product.id}')">
                            <div class="mini-card-title">ğŸ¦ ${product.name}</div>
                            <div class="mini-card-content">
                                <div style="margin-bottom: 8px;"><strong>${product.bank}</strong></div>
                                <div style="margin-bottom: 8px;">é¢åº¦: ${product.amount}</div>
                                <div style="margin-bottom: 8px;">åˆ©ç‡: <span style="color: #48bb78; font-weight: 600;">${product.rate}</span></div>
                                <div>æœŸé™: ${product.term}</div>
                                <div style="margin-top: 10px;">
                                    ${product.features.map(f => `<span class="badge badge-info">${f}</span>`).join(' ')}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <h4 style="margin-top: 30px; margin-bottom: 15px;">è¿‘æœŸæœåŠ¡æ¡ˆä¾‹</h4>
                <div class="timeline">
                    ${serviceData.cases.filter(c => c.serviceType === 'é‡‘èæœåŠ¡').map(c => `
                        <div class="timeline-item">
                            <div class="timeline-date">${c.date}</div>
                            <div class="timeline-content">
                                <div style="font-weight: 600; margin-bottom: 5px;">${c.companyName}</div>
                                <div style="margin-bottom: 5px;">${c.service} - ${c.amount}ä¸‡å…ƒ</div>
                                <div style="color: #48bb78;"><span class="badge ${c.status === 'å·²å‘æ”¾' ? 'badge-success' : 'badge-warning'}">${c.status}</span></div>
                                <div style="margin-top: 8px; font-size: 13px; color: #718096;">${c.effect}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>

            <div id="post-talent" class="tab-content">
                <h3 style="margin-bottom: 20px;">äººæ‰æœåŠ¡</h3>

                <div class="grid-2">
                    <div class="mini-card">
                        <h4>ğŸ‘¨â€ğŸ’¼ äººæ‰æ‹›è˜æœåŠ¡</h4>
                        <div style="margin-top: 15px;">
                            <div class="info-item">
                                <div class="info-label">æœ¬åœ°äººæ‰åº“</div>
                                <div class="info-value">25,000+ äºº</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">å¤–åœ°äººæ‰å¼•è¿›</div>
                                <div class="info-value">æœ¬å¹´ 890 äºº</div>
                            </div>
                            <button class="btn btn-primary" onclick="showTalentDatabase()" style="width: 100%; margin-top: 10px;">æŸ¥çœ‹äººæ‰åº“</button>
                        </div>
                    </div>

                    <div class="mini-card">
                        <h4>ğŸ“š äººæ‰åŸ¹è®­æœåŠ¡</h4>
                        <div style="margin-top: 15px;">
                            <div class="info-item">
                                <div class="info-label">åŸ¹è®­æœºæ„</div>
                                <div class="info-value">156 å®¶</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">åŸ¹è®­è¯¾ç¨‹</div>
                                <div class="info-value">2,340+ é—¨</div>
                            </div>
                            <button class="btn btn-primary" onclick="showTrainingPrograms()" style="width: 100%; margin-top: 10px;">æµè§ˆè¯¾ç¨‹</button>
                        </div>
                    </div>
                </div>

                <h4 style="margin-top: 30px; margin-bottom: 15px;">äººæ‰æ”¿ç­–</h4>
                <div class="card-grid">
                    ${policyData.list.filter(p => p.type === 'äººæ‰å¼•è¿›').map(policy => `
                        <div class="mini-card" onclick="showPolicyDetail2('${policy.id}')">
                            <div class="mini-card-title">${policy.title}</div>
                            <div class="mini-card-content">
                                <div style="margin-bottom: 8px;">è¡¥è´´é¢åº¦: <strong>${policy.amount}</strong></div>
                                <div>${policy.benefits.slice(0, 2).join('ã€')}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>

            <div id="post-industry" class="tab-content">
                <h3 style="margin-bottom: 20px;">äº§ä¸šèµ„æºå¯¹æ¥</h3>

                <div class="mini-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);">
                    <h4>ğŸ” ä¾›éœ€æ™ºèƒ½åŒ¹é…</h4>
                    <p style="margin-top: 10px; color: #4a5568;">è¾“å…¥ä¼ä¸šéœ€æ±‚ï¼Œæ™ºèƒ½æ¨èä¸Šä¸‹æ¸¸åˆä½œä¼™ä¼´</p>
                    <input type="text" placeholder="è¾“å…¥ä¼ä¸šåç§°æˆ–äº§å“å…³é”®è¯" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; margin-top: 10px;">
                    <button class="btn btn-primary" onclick="matchSupplyChain()" style="width: 100%; margin-top: 10px;">æ™ºèƒ½åŒ¹é…</button>
                </div>

                <h4 style="margin-top: 30px; margin-bottom: 15px;">å¯¹æ¥æ´»åŠ¨</h4>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>æ´»åŠ¨åç§°</th>
                                <th>æ—¶é—´</th>
                                <th>åœ°ç‚¹</th>
                                <th>å‚ä¸ä¼ä¸š</th>
                                <th>çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>é›†æˆç”µè·¯äº§ä¸šé“¾å¯¹æ¥ä¼š</td>
                                <td>2024-07-15</td>
                                <td>ä¸­å…³æ‘é›†æˆç”µè·¯å›­</td>
                                <td>56å®¶</td>
                                <td><span class="badge badge-info">æŠ¥åä¸­</span></td>
                            </tr>
                            <tr>
                                <td>AI+åˆ¶é€ äº§ä¸šå¯¹æ¥ä¼š</td>
                                <td>2024-07-20</td>
                                <td>åŒ—äº¬äº¦åº„</td>
                                <td>43å®¶</td>
                                <td><span class="badge badge-warning">ç­¹å¤‡ä¸­</span></td>
                            </tr>
                            <tr>
                                <td>ç”Ÿç‰©åŒ»è¯æŠ•èèµ„å¯¹æ¥</td>
                                <td>2024-06-28</td>
                                <td>æ˜Œå¹³ç”Ÿå‘½ç§‘å­¦å›­</td>
                                <td>67å®¶</td>
                                <td><span class="badge badge-success">å·²å®Œæˆ</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="post-monitoring" class="tab-content">
                <h3 style="margin-bottom: 20px;">ä¼ä¸šç›‘æµ‹é¢„è­¦</h3>

                <div class="stats-grid" style="margin-bottom: 20px;">
                    <div class="stat-card" style="border-left: 4px solid #48bb78;">
                        <div class="stat-title">å¥åº·ä¼ä¸š</div>
                        <div class="stat-value" style="color: #48bb78;">8,456</div>
                    </div>
                    <div class="stat-card" style="border-left: 4px solid #f6ad55;">
                        <div class="stat-title">é¢„è­¦ä¼ä¸š</div>
                        <div class="stat-value" style="color: #f6ad55;">234</div>
                    </div>
                    <div class="stat-card" style="border-left: 4px solid #f56565;">
                        <div class="stat-title">é£é™©ä¼ä¸š</div>
                        <div class="stat-value" style="color: #f56565;">45</div>
                    </div>
                </div>

                <h4 style="margin-bottom: 15px;">è¿‘æœŸé¢„è­¦</h4>
                <div class="card-grid">
                    <div class="mini-card" style="border-left-color: #f6ad55;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div class="mini-card-title">âš ï¸ æŸç§‘æŠ€å…¬å¸</div>
                            <span class="badge badge-warning">ä¸­é£é™©</span>
                        </div>
                        <div class="mini-card-content">
                            <div style="margin-bottom: 5px;">é¢„è­¦ç±»å‹: ç°é‡‘æµç´§å¼ </div>
                            <div style="margin-bottom: 5px;">è§¦å‘æ—¶é—´: 2024-06-25</div>
                            <div>å¤„ç†çŠ¶æ€: <span class="badge badge-info">è·Ÿè¿›ä¸­</span></div>
                        </div>
                    </div>

                    <div class="mini-card" style="border-left-color: #f56565;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <div class="mini-card-title">ğŸš¨ æŸåˆ¶é€ ä¼ä¸š</div>
                            <span class="badge badge-danger">é«˜é£é™©</span>
                        </div>
                        <div class="mini-card-content">
                            <div style="margin-bottom: 5px;">é¢„è­¦ç±»å‹: æ³•å¾‹è¯‰è®¼å¢å¤š</div>
                            <div style="margin-bottom: 5px;">è§¦å‘æ—¶é—´: 2024-06-20</div>
                            <div>å¤„ç†çŠ¶æ€: <span class="badge badge-warning">å·²ä»‹å…¥</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// åŠ è½½æ•°æ®ä¸­å°é¡µé¢
function loadDataCenterPage() {
    const container = document.getElementById('data-center');
    if (container.children.length > 0) return;

    container.innerHTML = `
        <div class="content-card">
            <div class="card-header">
                <h2 class="card-title">æ•°æ®ä¸­å°</h2>
            </div>

            <div class="stats-grid" style="margin-bottom: 30px;">
                <div class="stat-card">
                    <div class="stat-title">æ•°æ®æºæ¥å…¥</div>
                    <div class="stat-value">128</div>
                    <div class="stat-trend trend-up"><span>æœ¬æœˆ +12</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">æ•°æ®æ€»é‡</div>
                    <div class="stat-value">58.6TB</div>
                    <div class="stat-trend trend-up"><span>å¢é•¿ 15.2%</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">æ•°æ®æœåŠ¡API</div>
                    <div class="stat-value">456</div>
                    <div class="stat-trend"><span>è°ƒç”¨ 2.3Mæ¬¡/æ—¥</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-title">æ•°æ®è´¨é‡è¯„åˆ†</div>
                    <div class="stat-value">92.5</div>
                    <div class="stat-trend trend-up"><span>ä¼˜ç§€</span></div>
                </div>
            </div>

            <div class="grid-2">
                <div class="content-card">
                    <h3 style="margin-bottom: 20px;">æ•°æ®èµ„äº§ç›®å½•</h3>
                    <div class="mini-card">
                        <div class="mini-card-title">ğŸ“Š ä¼ä¸šæ•°æ®</div>
                        <div class="mini-card-content">
                            å·¥å•†æ•°æ®ã€ç¨åŠ¡æ•°æ®ã€ç¤¾ä¿æ•°æ®ã€ä¿¡ç”¨æ•°æ®ç­‰
                            <div style="margin-top: 10px;">
                                <span class="badge badge-success">å·²æ¥å…¥</span>
                                <span class="badge badge-info">å®æ—¶æ›´æ–°</span>
                            </div>
                        </div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-title">ğŸ­ äº§ä¸šæ•°æ®</div>
                        <div class="mini-card-content">
                            äº§ä¸šé“¾æ•°æ®ã€å¸‚åœºæ•°æ®ã€æŠ€æœ¯æ•°æ®ã€äººæ‰æ•°æ®ç­‰
                            <div style="margin-top: 10px;">
                                <span class="badge badge-success">å·²æ¥å…¥</span>
                                <span class="badge badge-warning">æ—¥æ›´æ–°</span>
                            </div>
                        </div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-title">ğŸ“‹ æ”¿ç­–æ•°æ®</div>
                        <div class="mini-card-content">
                            å›½å®¶æ”¿ç­–ã€åœ°æ–¹æ”¿ç­–ã€è¡Œä¸šæ”¿ç­–ç­‰
                            <div style="margin-top: 10px;">
                                <span class="badge badge-success">å·²æ¥å…¥</span>
                                <span class="badge badge-info">å®æ—¶æ›´æ–°</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-card">
                    <h3 style="margin-bottom: 20px;">æ•°æ®åº”ç”¨</h3>
                    <div class="mini-card">
                        <div class="mini-card-title">ğŸ¤– å¤§æ¨¡å‹æœåŠ¡</div>
                        <div class="mini-card-content">
                            äº§ä¸šåˆ†æã€æ™ºèƒ½é—®ç­”ã€æŠ¥å‘Šç”Ÿæˆã€è¶‹åŠ¿é¢„æµ‹
                        </div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-title">ğŸ•¸ï¸ çŸ¥è¯†å›¾è°±</div>
                        <div class="mini-card-content">
                            äº§ä¸šé“¾å›¾è°±ã€ä¼ä¸šå…³ç³»å›¾è°±ã€æ”¿ç­–çŸ¥è¯†å›¾è°±
                        </div>
                    </div>
                    <div class="mini-card">
                        <div class="mini-card-title">ğŸ“ˆ BIåˆ†æ</div>
                        <div class="mini-card-content">
                            å¯è§†åŒ–å¤§å±ã€è‡ªåŠ©åˆ†æã€æ™ºèƒ½æŠ¥è¡¨
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}

// Tabåˆ‡æ¢å‡½æ•°
function switchPreTab(tabId) {
    document.querySelectorAll('#pre-investment .tab-content').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('#pre-investment .tab').forEach(el => el.classList.remove('active'));

    document.getElementById('pre-' + tabId).classList.add('active');
    event.target.classList.add('active');
}

function switchMidTab(tabId) {
    document.querySelectorAll('#mid-investment .tab-content').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('#mid-investment .tab').forEach(el => el.classList.remove('active'));

    document.getElementById('mid-' + tabId).classList.add('active');
    event.target.classList.add('active');
}

function switchPostTab(tabId) {
    document.querySelectorAll('#post-investment .tab-content').forEach(el => el.classList.remove('active'));
    document.querySelectorAll('#post-investment .tab').forEach(el => el.classList.remove('active'));

    document.getElementById('post-' + tabId).classList.add('active');
    event.target.classList.add('active');
}

// æ”¿ç­–åŒ¹é…åŠŸèƒ½
function matchPolicies(enterpriseId) {
    if (!enterpriseId) return;

    const enterprise = enterpriseData.list.find(e => e.id == enterpriseId);
    if (!enterprise) return;

    const matchedPolicies = policyData.list.filter(policy => {
        return policy.industry.includes('å…¨è¡Œä¸š') || policy.industry.includes(enterprise.type);
    });

    let html = `
        <div class="mini-card" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);">
            <h4>ä¼ä¸šä¿¡æ¯</h4>
            <div class="grid-2" style="margin-top: 10px;">
                <div class="info-item">
                    <div class="info-label">ä¼ä¸šåç§°</div>
                    <div class="info-value">${enterprise.name}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">è¡Œä¸š</div>
                    <div class="info-value">${enterprise.type}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">å‘å±•é˜¶æ®µ</div>
                    <div class="info-value">${enterprise.stage}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">å¹´è¥æ”¶</div>
                    <div class="info-value">${enterprise.revenue}ä¸‡å…ƒ</div>
                </div>
            </div>
        </div>

        <h4 style="margin: 20px 0 15px 0;">åŒ¹é…æ”¿ç­– (${matchedPolicies.length}æ¡)</h4>
        <div class="card-grid">
            ${matchedPolicies.map((policy, index) => `
                <div class="mini-card" onclick="showPolicyDetail2('${policy.id}')">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <div class="mini-card-title">${policy.title}</div>
                        <span class="badge badge-success">${95 - index * 5}%</span>
                    </div>
                    <div class="mini-card-content">
                        <div style="margin-bottom: 8px;">ç±»å‹: ${policy.type}</div>
                        <div style="margin-bottom: 8px;">é¢åº¦: <strong>${policy.amount}</strong></div>
                        <div>${policy.benefits[0]}</div>
                    </div>
                </div>
            `).join('')}
        </div>
    `;

    document.getElementById('policyMatchResult').innerHTML = html;
    showNotification(`ä¸º ${enterprise.name} åŒ¹é…åˆ° ${matchedPolicies.length} æ¡æ”¿ç­–`, 'success');
}

// å…¶ä»–è¾…åŠ©å‡½æ•°
function generateAnalysisReport() {
    showNotification('æ­£åœ¨ç”Ÿæˆåˆ†ææŠ¥å‘Š...', 'info');
    setTimeout(() => {
        showNotification('åˆ†ææŠ¥å‘Šç”Ÿæˆå®Œæˆ', 'success');
    }, 2000);
}

function showEnterpriseAnalysis(id) {
    const enterprise = enterpriseData.list.find(e => e.id === id);
    if (!enterprise) return;

    const html = `
        <div class="grid-2">
            <div class="info-item"><div class="info-label">æ³¨å†Œèµ„æœ¬</div><div class="info-value">${enterprise.registeredCapital.toLocaleString()}ä¸‡å…ƒ</div></div>
            <div class="info-item"><div class="info-label">å¹´è¥æ”¶</div><div class="info-value">${enterprise.revenue.toLocaleString()}ä¸‡å…ƒ</div></div>
            <div class="info-item"><div class="info-label">çº³ç¨é¢</div><div class="info-value">${enterprise.tax.toLocaleString()}ä¸‡å…ƒ</div></div>
            <div class="info-item"><div class="info-label">å‘˜å·¥æ•°</div><div class="info-value">${enterprise.employees}äºº</div></div>
            <div class="info-item"><div class="info-label">æˆç«‹æ—¶é—´</div><div class="info-value">${enterprise.foundedYear}å¹´</div></div>
            <div class="info-item"><div class="info-label">ä¿¡ç”¨ç­‰çº§</div><div class="info-value"><span class="badge badge-success">${enterprise.credit}</span></div></div>
            <div class="info-item"><div class="info-label">åˆ›æ–°è¯„åˆ†</div><div class="info-value">${enterprise.innovation}/5.0</div></div>
            <div class="info-item"><div class="info-label">ä¸“åˆ©æ•°é‡</div><div class="info-value">${enterprise.patents}é¡¹</div></div>
        </div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">ä¸»è¦äº§å“</h4>
        <div>${enterprise.products.map(p => `<span class="badge badge-info">${p}</span>`).join(' ')}</div>
        <div id="enterpriseRadarChart" style="width: 100%; height: 300px; margin-top: 20px;"></div>
    `;

    showModal(enterprise.name + ' - ä¼ä¸šç”»åƒ', html);
    setTimeout(() => initEnterpriseRadarChart(id), 100);
}

function showProjectDetail(id) {
    const project = investmentData.projects.find(p => p.id === id);
    if (!project) return;

    const html = `
        <div class="grid-2">
            <div class="info-item"><div class="info-label">é¡¹ç›®åç§°</div><div class="info-value">${project.name}</div></div>
            <div class="info-item"><div class="info-label">è¡Œä¸š</div><div class="info-value">${project.industry}</div></div>
            <div class="info-item"><div class="info-label">æŠ•èµ„é‡‘é¢</div><div class="info-value">${project.investAmount.toLocaleString()}ä¸‡å…ƒ</div></div>
            <div class="info-item"><div class="info-label">é¢„æœŸäº§å€¼</div><div class="info-value">${project.expectedOutput.toLocaleString()}ä¸‡å…ƒ</div></div>
            <div class="info-item"><div class="info-label">é¢„æœŸç¨æ”¶</div><div class="info-value">${project.expectedTax.toLocaleString()}ä¸‡å…ƒ</div></div>
            <div class="info-item"><div class="info-label">é¢„æœŸå°±ä¸š</div><div class="info-value">${project.expectedJobs}äºº</div></div>
            <div class="info-item"><div class="info-label">é¡¹ç›®è¿›åº¦</div><div class="info-value">${project.progress}%</div></div>
            <div class="info-item"><div class="info-label">é¡¹ç›®çŠ¶æ€</div><div class="info-value"><span class="badge badge-info">${project.stage}</span></div></div>
        </div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">åŒ¹é…æ”¿ç­–</h4>
        <div>${project.policyPackage.map(pid => {
            const p = policyData.list.find(pol => pol.id === pid);
            return p ? `<span class="badge badge-success">${p.title}</span>` : '';
        }).join(' ')}</div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">é¡¹ç›®ä¼˜åŠ¿</h4>
        <div>${project.advantages.map(a => `<div class="mini-card">âœ“ ${a}</div>`).join('')}</div>
    `;

    showModal('æ‹›å•†é¡¹ç›®è¯¦æƒ…', html);
}

function showPolicyDetail2(id) {
    const policy = policyData.list.find(p => p.id === id);
    if (!policy) return;

    const html = `
        <div class="grid-2">
            <div class="info-item"><div class="info-label">æ”¿ç­–çº§åˆ«</div><div class="info-value">${policy.level}</div></div>
            <div class="info-item"><div class="info-label">æ”¿ç­–ç±»å‹</div><div class="info-value">${policy.type}</div></div>
            <div class="info-item"><div class="info-label">æ”¯æŒé¢åº¦</div><div class="info-value">${policy.amount}</div></div>
            <div class="info-item"><div class="info-label">æœ‰æ•ˆæœŸ</div><div class="info-value">${policy.effectiveDate} è‡³ ${policy.expireDate}</div></div>
        </div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">é€‚ç”¨è¡Œä¸š</h4>
        <div>${policy.industry.map(i => `<span class="badge badge-info">${i}</span>`).join(' ')}</div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">ç”³æŠ¥æ¡ä»¶</h4>
        <div>${policy.conditions.map(c => `<div class="mini-card">â€¢ ${c}</div>`).join('')}</div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">æ”¿ç­–ä¼˜æƒ </h4>
        <div>${policy.benefits.map(b => `<div class="mini-card">âœ“ ${b}</div>`).join('')}</div>
        <h4 style="margin-top: 20px; margin-bottom: 10px;">ç”³æŠ¥æµç¨‹</h4>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            ${policy.applyProcess.map((step, i) => `<span class="badge badge-success">${i + 1}. ${step}</span>`).join('')}
        </div>
    `;

    showModal(policy.title, html);
}

// æœç´¢åŠŸèƒ½
function searchIndustry(keyword) {
    // å®ç°æœç´¢é€»è¾‘
    console.log('æœç´¢äº§ä¸š:', keyword);
}

function searchEnterprise(keyword) {
    // å®ç°æœç´¢é€»è¾‘
    console.log('æœç´¢ä¼ä¸š:', keyword);
}

// æ·»åŠ åŠ¨ç”»æ ·å¼
const style = document.createElement('style');
style.textContent = `
    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes slideOutRight {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);